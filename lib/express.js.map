{"version":3,"sources":["express.js"],"names":[],"mappings":";;AAAA,IAAM,QAAQ,QAAQ,SAAR,CAAR;AACN,IAAM,SAAS,QAAQ,QAAR,CAAT;;AAEN,OAAO,OAAP,GAAiB,UAAU,GAAV,EAAe,OAAf,EAAwB;aACD,WAAW,EAAX,CADC;;MACjC,qBADiC;MACzB,yBADyB;MACf,eADe;MACV,iBADU;;AAEvC,QAAM,OAAO,YAAP,CAFiC;AAGvC,SAAO,QAAQ,QAAR,CAHgC;;AAKvC,SAAO,IAAP,EAAa,kBAAb,EALuC;AAMvC,MAAI,MAAJ,EAAY;AACV,WAAO,QAAP,EAAiB,sBAAjB,EADU;GAAZ;;AAIA,SAAO,UAAU,GAAV,EAAe,GAAf,EAAoB,IAApB,EAA0B;AAC/B,QAAI,QAAQ,QAAQ,GAAR,CAAY,GAAZ,CAAR,CAD2B;AAE/B,QAAI,oBAAJ,CAF+B;;AAI/B,YAAQ,IAAR;AACE,WAAK,QAAL;AACE,mBAAW,IAAI,OAAJ,IAAe,IAAI,OAAJ,CAAY,GAAZ,CAAf,CADb;AAEE,cAFF;AADF,WAIO,OAAL;AACE,mBAAW,IAAI,KAAJ,IAAa,IAAI,KAAJ,CAAU,GAAV,CAAb,CADb;AAEE,cAFF;AAJF,KAJ+B;;AAa/B,QAAI,QAAJ,EAAc;AACZ,UAAI,MAAJ,EAAY;AACV,mBAAW,MAAM,cAAN,CAAqB,QAArB,EAA+B,QAA/B,CAAX,CADU;OAAZ;AAGA,cAAQ,GAAR,kBAA2B,aAAQ,QAAnC,EAJY;AAKZ,cAAQ,GAAR,CAAY,GAAZ,IAAmB,QAAnB,CALY;KAAd;;AAQA,QAAI;AACF,aADE;KAAJ,SAEU;AACR,UAAI,QAAJ,EAAc;AACZ,gBAAQ,GAAR,sBAA+B,aAAQ,KAAvC,EADY;AAEZ,gBAAQ,GAAR,CAAY,GAAZ,IAAmB,KAAnB,CAFY;OAAd;KAHF;GArBK,CAVgC;CAAxB","file":"express.js","sourcesContent":["const utils = require('./utils')\nconst assert = require('assert')\n\nmodule.exports = function (key, options) {\n  let { secure, password, env, type } = options || {}\n  env = env || 'NODE_DEBUG'\n  type = type || 'cookie'\n\n  assert(type, 'type is required')\n  if (secure) {\n    assert(password, 'password is required')\n  }\n\n  return function (req, res, next) {\n    let debug = process.env[env]\n    let newDebug\n\n    switch (type) {\n      case 'cookie':\n        newDebug = req.cookies && req.cookies[key]\n        break\n      case 'query':\n        newDebug = req.query && req.query[key]\n        break\n    }\n\n    if (newDebug) {\n      if (secure) {\n        newDebug = utils.decode64Cipher(newDebug, password)\n      }\n      console.log(`Set the env ${env}: ${newDebug}`)\n      process.env[env] = newDebug\n    }\n\n    try {\n      next()\n    } finally {\n      if (newDebug) {\n        console.log(`Restore the env ${env}: ${debug}`)\n        process.env[env] = debug\n      }\n    }\n  }\n}\n"],"sourceRoot":"/src"}